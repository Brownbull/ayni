# Ayni Backend Environment Configuration
# Copy this file to ../.env (project root) and fill in the values
# DO NOT commit the actual .env file - it contains secrets

# ============================================================================
# PROJECT CONFIGURATION
# ============================================================================
PROJECT_NAME=Ayni

# ============================================================================
# ENVIRONMENT
# ============================================================================
# Values: local, staging, production
# Controls validation strictness and default secret warnings
ENVIRONMENT=local

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
# Local: Use docker-compose PostgreSQL (see docker-compose.yml)
# Production: Auto-provided by Railway PostgreSQL service as DATABASE_URL
# The app builds SQLALCHEMY_DATABASE_URI from these components

POSTGRES_SERVER=localhost
POSTGRES_PORT=5432
POSTGRES_USER=ayni_user
POSTGRES_PASSWORD=changethis
POSTGRES_DB=ayni_dev

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================
# Local: Use docker-compose Redis (see docker-compose.yml)
# Production: Auto-provided by Railway Redis service
# Used for caching and as Celery broker/backend

REDIS_URL=redis://localhost:6379/0

# ============================================================================
# CELERY CONFIGURATION (Optional - defaults to REDIS_URL)
# ============================================================================
# Celery broker: Uses Redis database 0
# Celery results: Uses Redis database 1
# These are computed automatically from REDIS_URL if not specified

# CELERY_BROKER_URL=redis://localhost:6379/0
# CELERY_RESULT_BACKEND=redis://localhost:6379/1

# ============================================================================
# SECURITY - JWT CONFIGURATION
# ============================================================================
# CRITICAL: JWT_SECRET must be 64+ characters for production security
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(64))"
# NEVER use "changethis" in production - app will fail to start
# Rotate quarterly or on suspected compromise

JWT_SECRET=changethis-REPLACE-WITH-SECURE-64-CHAR-RANDOM-STRING-SEE-COMMAND-ABOVE
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=11520

# CRITICAL: Legacy SECRET_KEY for session management
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
SECRET_KEY=changethis-secret-key-for-local-dev-only

# ============================================================================
# CORS CONFIGURATION
# ============================================================================
# Local: Frontend dev server
# Production: Add your production frontend URL (e.g., Render deployment)
# Multiple origins: Use JSON array format

FRONTEND_HOST=http://localhost:5173
BACKEND_CORS_ORIGINS=["http://localhost:5173"]

# ============================================================================
# ADMIN/SUPERUSER CONFIGURATION
# ============================================================================
# First superuser created during database initialization
# NEVER use "changethis" in production

FIRST_SUPERUSER=admin@example.com
FIRST_SUPERUSER_PASSWORD=changethis

# ============================================================================
# EMAIL CONFIGURATION (Optional)
# ============================================================================
# SMTP settings for email notifications (password reset, etc.)
# Leave blank to disable email functionality

SMTP_TLS=True
SMTP_SSL=False
SMTP_PORT=587
SMTP_HOST=
SMTP_USER=
SMTP_PASSWORD=
EMAILS_FROM_EMAIL=
EMAILS_FROM_NAME=

# Email token expiration (hours)
EMAIL_RESET_TOKEN_EXPIRE_HOURS=48

# Test user email (for development/testing)
EMAIL_TEST_USER=test@example.com

# ============================================================================
# MONITORING & OBSERVABILITY (Optional)
# ============================================================================
# Sentry DSN for error tracking
# Leave blank to disable Sentry

SENTRY_DSN=

# ============================================================================
# DOCKER COMPOSE CONFIGURATION (Local Development Only)
# ============================================================================
# Used by docker-compose.yml - not needed for Railway deployment

STACK_NAME=ayni-stack
DOMAIN=localhost
DOCKER_IMAGE_BACKEND=ayni-backend
DOCKER_IMAGE_FRONTEND=ayni-frontend

# ============================================================================
# GOOGLE OAUTH 2.0 CONFIGURATION (Story 2.5)
# ============================================================================
# Google OAuth 2.0 credentials for "Sign in with Google" functionality
# OPTIONAL: If not configured, OAuth endpoints return 503 (app still works with email/password)
#
# Setup Instructions:
# 1. Create project at https://console.cloud.google.com
# 2. Enable Google+ API (or People API for newer projects)
# 3. Configure OAuth consent screen (app name, support email, logo)
# 4. Create OAuth 2.0 Client ID (Web application type)
# 5. Add authorized redirect URIs:
#    - Local dev: http://localhost:8000/api/v1/auth/google/callback
#    - Production: https://your-domain.com/api/v1/auth/google/callback
# 6. Copy Client ID and Client Secret here

GOOGLE_OAUTH_CLIENT_ID=your_client_id_here.apps.googleusercontent.com
GOOGLE_OAUTH_CLIENT_SECRET=your_client_secret_here
GOOGLE_OAUTH_REDIRECT_URI=http://localhost:8000/api/v1/auth/google/callback

# Production redirect URI (change in production deployment):
# GOOGLE_OAUTH_REDIRECT_URI=https://api.ayni.cl/api/v1/auth/google/callback

# ============================================================================
# PRODUCTION DEPLOYMENT NOTES
# ============================================================================
# Railway Backend Environment Variables (set via Railway dashboard):
#   - DATABASE_URL: Auto-provided by PostgreSQL service
#   - REDIS_URL: Auto-provided by Redis service
#   - JWT_SECRET: Generate 64+ char string (REQUIRED)
#   - FRONTEND_HOST: Your Render frontend URL (e.g., https://ayni.render.com)
#   - ENVIRONMENT: Set to "production"
#   - FIRST_SUPERUSER: Admin email
#   - FIRST_SUPERUSER_PASSWORD: Strong password
#
# Render Frontend Environment Variables (set via Render dashboard):
#   - VITE_API_URL: Your Railway backend URL (e.g., https://ayni-backend.railway.app/api/v1)
#   - VITE_ENVIRONMENT: Set to "production"
